# Create new....
SELECT MIN(rental_rate) AS min_rental_rate,		
       MAX(rental_rate) AS max_rent_rate,		
       AVG(rental_rate) AS avg_rent_rate,		
       COUNT(*) AS count_films,		
	   MIN(replacement_cost) AS min_replacement_cost,	
	   MAX(replacement_cost) AS max_replacement_cost,	
	   AVG(replacement_cost) AS avg_replacement_cost,	
	   MIN(length) AS min_length,	
	   MAX(length) AS max_length,	
	   AVG(length) AS avg_length,	
	   mode() WITHIN GROUP (ORDER BY rating) 	
	   	AS modal_value
FROM film;		

# Use Common Table Expressions to find AVG of Top 5 Customers
WITH top_five_customers (customer_id, country, total_amount) AS
(SELECT A.customer_id, D. country,
SUM(E.amount) AS total_amount FROM customer A
INNER JOIN address B ON A.address_id = B.address_id INNER JOIN city C ON B.city_id = C.city_id
INNER JOIN country D ON C.city_id = D.country_id
INNER JOIN payment E ON A.customer_id = E.customer_id GROUP BY A.customer_id, city, country
ORDER BY total_amount DESC LIMIT 5)
SELECT AVG(total_amount) FROM top_five_customers
